<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Analyze Widget</title>

    <!-- Include jQuery from CDN -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Include Chart.js from CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Include DataTables CSS from CDN -->
    <link
      rel="stylesheet"
      href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css"
    />
    <!-- Include DataTables JS from CDN -->
    <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
    <!-- Include Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Includes Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
  </head>
  <body>
    <!-- Tabs -->
    <div class="border-b border-gray-200 px-3">
      <ul
        class="flex flex-wrap -mb-px text-sm font-medium text-center text-gray-500 dark:text-gray-400 py-2"
        id="tabs"
      >
        <li class="me-2">
          <button
            class="main-tab-button inline-flex gap-1 items-center justify-center px-4 py-3.5 group"
            id="analyze-tab"
          >
            <i data-lucide="chart-spline" class="w-4 h-4"></i>
            Analyze
          </button>
        </li>
        <li class="me-2">
          <button
            class="main-tab-button inline-flex gap-1 items-center justify-center px-4 py-3.5 group"
            id="history-tab"
          >
            <i data-lucide="history" class="w-4 h-4"></i>
            History Positions
          </button>
        </li>
      </ul>
    </div>
    <!-- End Tabs -->

    <!-- Analyze Tab Content -->
    <!-- <div id="analyze-loading" class="px-3">Loading ...</div> -->
    <div
      id="analyze"
      class="tab-content p-3 hidden grid grid-cols-4 gap-x-3 gap-y-3 bg-gray-100"
    >
      <!-- Summary Stats -->
      <div class="summary-card rounded-xl shadow bg-white p-5 col-span-4">
        <div
          class="summary-card-content grid grid-cols-2 lg:grid-cols-4 xl:grid-cols-8 gap-x-3 gap-y-10 col-span-4"
        >
          <!-- Stat cards will be appended here -->
        </div>
      </div>
      <!-- End Summary Stats -->

      <!-- Summary Chart -->
      <div class="rounded-2xl shadow bg-white p-6 col-span-4 md:col-span-2">
        <div class="text-lg font-semibold mb-4">Financial Overview</div>
        <div class="w-full h-[260px]">
          <canvas id="summaryChart"></canvas>
        </div>
      </div>
      <!-- End Summary Chart -->

      <!-- Prop Analyze -->
      <div class="rounded-2xl col-span-4 md:col-span-2">
        <!-- <h2 class="text-lg font-semibold mb-6">Prop Analyze</h2> -->
        <div class="grid lg:grid-cols-2 gap-3" id="prop-analyze-content">
          <!-- Render Prop Analyze Items -->
        </div>
      </div>
      <!-- End Prop Analyze -->

      <!-- Max Drawdown Items -->
      <!-- <div
        id="max-drawdown-loading"
        class="w-full h-[200px] grid lg:grid-cols-2 gap-3 2xl:grid-cols-4 col-span-4"
      >
        <div
          class="rounded-2xl bg-white shadow flex justify-center items-center"
        >
          Loading ...
        </div>
        <div
          class="rounded-2xl bg-white shadow flex justify-center items-center"
        >
          Loading ...
        </div>
        <div
          class="rounded-2xl bg-white shadow flex justify-center items-center"
        >
          Loading ...
        </div>
        <div
          class="rounded-2xl bg-white shadow flex justify-center items-center"
        >
          Loading ...
        </div>
      </div> -->
      <div
        id="max-drawdown-content"
        class="w-full grid lg:grid-cols-2 gap-3 2xl:grid-cols-4 col-span-4"
      >
        <!-- Render Max Drawdown -->
      </div>
      <!-- End Max Drawdown Items -->

      <!-- History Charts -->
      <div class="card col-span-4 p-5 rounded-2xl bg-white shadow">
        <div class="card-header flex md:flex-row justify-between gap-y-5">
          <div class="text-lg font-medium flex items-center gap-2">
            Balance & Growth
          </div>
          <div class="tabs-list w-fit p-1 rounded-xl bg-gray-100">
            <button class="history-tabs-button px-3 py-1" id="balance-tab">
              balance
            </button>
            <button class="history-tabs-button px-3 py-1" id="growth-tab">
              growth
            </button>
          </div>
        </div>
        <div id="history-charts-content">
          <div class="" id="balance">
            <div>asasasasfd</div>
            <canvas id="balanceChart" class="max-h-[550px]"></canvas>
          </div>
          <div class="" id="growth">
            <div>asasasasfd</div>
            <canvas id="growthChart" class="max-h-[550px]"></canvas>
          </div>
        </div>
      </div>
      <!-- End History Charts -->
    </div>
    <!-- End Analyze Tab Content -->

    <!-- History Tabs Content -->
    <div id="history" class="tab-content hidden">
      <h2 class="text-center mt-8">Sales Records</h2>
      <div style="width: 70%; margin: auto">
        <table id="salesTable" class="display">
          <thead>
            <tr>
              <th>Month</th>
              <th>Sales</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>January</td>
              <td>120</td>
            </tr>
            <tr>
              <td>February</td>
              <td>150</td>
            </tr>
            <tr>
              <td>March</td>
              <td>180</td>
            </tr>
            <tr>
              <td>April</td>
              <td>220</td>
            </tr>
            <tr>
              <td>May</td>
              <td>260</td>
            </tr>
            <tr>
              <td>June</td>
              <td>300</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <!-- End History Tabs Content -->

    <script>
      lucide.createIcons();

      // Fetching Data
      async function fetchData(url) {
        try {
          const response = await fetch(url, {
            headers: {
              APIKey:
                "6a4ce048dffdc0637965e1128a551b54983aa6e61cb28ec9df692c3184683d20",
            },
          });

          if (!response.ok) {
            throw new Error("Network response was not ok");
          }
          const data = await response.json();
          console.log(response);

          return data;
        } catch (error) {
          console.error("There was a problem with the fetch operation:", error);
          return null;
        }
      }
      // End Fetching Data

      // Summary Stats Functionality
      function formatValue(value) {
        return new Intl.NumberFormat("en-US", {
          style: "currency",
          currency: "USD",
          minimumFractionDigits: 2,
          maximumFractionDigits: 2,
        }).format(value);
      }

      function createSumStatCard(title, value, iconName) {
        var trendIcon =
          value >= 0
            ? '<i data-lucide="trending-up" class="text-green-500 w-4 h-4"></i>'
            : '<i data-lucide="trending-down" class="text-red-500 w-4 h-4"></i>';

        return `
          <div>
            <div class="flex gap-1 flex-row items-center space-y-0 pb-2">
              <i data-lucide="${iconName}" class="w-4 h-4 text-gray-500"></i>
              <div class="text-sm font-medium">${title}</div>
            </div>
            <div>
              <div class="text-xl font-semibold">${formatValue(value)}</div>
              <p class="text-xs text-muted-foreground flex gap-1">
                ${trendIcon} ${Math.abs(value).toFixed(2)}
              </p>
            </div>
          </div>
        `;
      }

      function renderSumStats(data) {
        var statsContainer = $(".summary-card-content");
        statsContainer.empty();

        statsContainer.append(
          createSumStatCard("Profit", data.SumProfit, "dollar-sign")
        );
        statsContainer.append(
          createSumStatCard("Commission", data.SumCommission, "scale")
        );
        statsContainer.append(
          createSumStatCard("Net Profit", data.SumNetProfit, "dollar-sign")
        );
        statsContainer.append(
          createSumStatCard("Swap", data.SumSwap, "arrow-left-right")
        );
        statsContainer.append(
          createSumStatCard("Withdrawals", data.SumWithdrawals, "arrow-up")
        );
        statsContainer.append(
          createSumStatCard("Deposits", data.SumDeposits, "arrow-down")
        );
        statsContainer.append(
          createSumStatCard("Start Balance", data.StartBalance, "wallet")
        );
        statsContainer.append(
          createSumStatCard(
            "Balance Drawdown",
            data.BalanceDrawdown,
            "arrow-down"
          )
        );

        lucide.createIcons();
      }
      // End Summary Stats Functionality

      // Summary Charts Functionality
      const renderSumChart = (data) => {
        const formatChart = (name, value) => {
          return {
            name: name,
            originalValue: value,
            value: Math.abs(value).toFixed(2),
            backgroundColor: value < 0 ? "#f43f5e" : "#3b82f6",
          };
        };

        const dataChart = [
          formatChart("Sum Profit", data.SumProfit),
          formatChart("Sum Commission", data.SumCommission),
          formatChart("Sum Deposits", data.SumDeposits),
          formatChart("Sum Net Profit", data.SumNetProfit),
          formatChart("Sum Swap", data.SumSwap),
          formatChart("Sum Withdrawals", data.SumWithdrawals),
        ];

        const labels = dataChart.map((item) => item.name);
        const chartData = dataChart.map((item) => parseFloat(item.value));
        const backgroundColors = dataChart.map((item) => item.backgroundColor);

        const ctx = $("#summaryChart");
        const myChart = new Chart(ctx, {
          type: "bar",
          data: {
            labels: labels,
            datasets: [
              {
                label: "Financial Overview",
                data: chartData,
                backgroundColor: backgroundColors,
                borderColor: backgroundColors,
                borderRadius: 8,
                // barThickness: 30,
              },
            ],
          },
          options: {
            indexAxis: "y", // Set this for horizontal bars
            scales: {
              x: {
                beginAtZero: true,
                grid: {
                  display: true,
                  drawBorder: false,
                  // color: (context) => {},
                  borderDash: [3, 5],
                },
                ticks: {
                  padding: 10,
                  display: true,
                },
              },
              y: {
                grid: {
                  display: false,
                },
                ticks: {
                  padding: 15,
                  display: true,
                },
              },
            },
            plugins: {
              tooltip: {
                callbacks: {
                  label: function (context) {
                    return `Value: ${context.raw}`;
                  },
                },
              },
            },
            maintainAspectRatio: false,
            responsive: true,
          },
        });
      };
      // End Summary Charts Functionality

      // Prop Analyze Functionality
      const renderPropAnalyze = (data) => {
        const propData = [
          {
            label: "6 Day Trade",
            value: data.DayTrade,
            max: 6,
            icon: "clock",
            iconColor: "text-blue-400",
            status: data.DayTrade >= 6 ? "passed" : "stable",
            unit: "Day",
          },
          {
            label: "6 Day Complete Lot",
            value: data.DayTradeCompleteVolume,
            max: 6,
            icon: "trending-up",
            iconColor: "text-purple-400",
            status: data.DayTradeCompleteVolume >= 6 ? "passed" : "stable",
            unit: "Day",
          },
          {
            label: "3 Min Trade",
            value: data.TradeLimitTime,
            max: 3,
            icon: "activity",
            iconColor: "text-rose-400",
            status: data.TradeLimitTime >= 3 ? "rejected" : "passed",
            unit: "Trade",
          },
          {
            label: "Relative Drawdown",
            value: data.RelativeDrawdown,
            max: 3,
            icon: "percent",
            iconColor: "text-yellow-400",
            status: "none",
            unit: "%",
          },
        ];

        propData.forEach((item) => {
          const statusBadge = getStatusBadge(item.status);
          const fillColor = getFillColor(item.status);
          const chartId = `chart-${item.label
            .replace(/\s+/g, "-")
            .toLowerCase()}`;

          const html = `
            <div class="space-y-4 shadow bg-white rounded-2xl p-6">
              <div class="flex items-center justify-between">
                <div class="flex items-center space-x-2">
                  <i data-lucide="${item.icon}" class="w-5 h-5 ${item.iconColor}"></i>
                  <span class="text-base font-semibold">${item.label}</span>
                </div>
                ${statusBadge}
              </div>
              <div class="flex items-center space-x-4">
                <div><canvas id="${chartId}" width="80" height="80"></canvas></div>
                <div>
                  <p class="text-xl font-semibold">${item.value} ${item.unit}</p>
                  <p class="text-sm text-gray-400">Progress</p>
                </div>
              </div>
            </div>
          `;

          $("#prop-analyze-content").append(html);

          lucide.createIcons();

          renderChart(chartId, item.value, item.max, fillColor);
        });

        function getStatusBadge(status) {
          switch (status) {
            case "passed":
              return '<span class="bg-green-100 text-green-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded">Passed</span>';
            case "stable":
              return '<span class="bg-blue-100 text-blue-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded">Stable</span>';
            case "rejected":
              return '<span class="bg-red-100 text-red-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded">Rejected</span>';
            default:
              return '<span class="bg-gray-100 text-gray-800 text-xs font-medium me-2 px-2.5 py-0.5 rounded">None</span>';
          }
        }

        function getFillColor(status) {
          switch (status) {
            case "passed":
              return "#22c55e";
            case "stable":
              return "#3b82f6";
            case "rejected":
              return "#f43f5e";
            default:
              return "#a855f7";
          }
        }

        function renderChart(chartId, value, max, fillColor) {
          const ctx = document.getElementById(chartId).getContext("2d");
          const step = 100 / max;
          new Chart(ctx, {
            type: "doughnut",
            data: {
              datasets: [
                {
                  data:
                    value <= max ? [value * step, 100 - value * step] : [value],
                  backgroundColor: [fillColor, "#e5e7eb"],
                  borderWidth: 0,
                },
              ],
            },
            options: {
              // circumference: Math.PI,
              // rotation: -Math.PI,
              cutout: "70%",
              responsive: true,
              maintainAspectRatio: false,
              animation: {
                animateRotate: true,
                animateScale: true,
              },
              plugins: {
                tooltip: { enabled: false },
              },
            },
          });
        }
      };
      // End Prop Analyze Functionality

      // Max Drawdowm Functionality
      const renderMaxDrawdown = (data) => {
        const maxDrawDownData = [
          {
            title: "Start",
            value: data.MaxStartBalanceDrawdown * 100,
            time: data.MaxStartBalanceDrawdownTime,
            max: data.PerStartRole,
          },
          {
            title: "EOD",
            value: data.MaxEODBalanceDrawdown * 100,
            time: data.MaxEODBalanceDrawdownTime,
            max: data.PerEODRole,
          },
          {
            title: "MAT",
            value: data.MaxAllTimeBalanceDrawdown * 100,
            time: data.MaxAllTimeBalanceDrawdownTime,
            max: data.PerStartRole,
          },
          {
            title: "MD",
            value: data.MaxDayBalanceDrawdown * 100,
            time: data.MaxDayBalanceDrawdownTime,
            max: data.PerMDRole,
          },
        ];

        maxDrawDownData.forEach(({ value, max, time, title }) => {
          const status = value < max ? "stable" : "rejected";

          const badge = getBadge(status);
          const progress = getProgress(value, max);

          const date = new Date(time);

          const html = `
                      <div class="overflow-hidden rounded-2xl shadow bg-white p-4">
                        <div class="flex flex-row justify-between items-center pb-4">
                          <h2 class="text-base font-medium">${title} balance max drawdown</h2>
                        </div>
                        <div class="">
                          <div class="flex items-center justify-between mb-2">
                            <span class="text-2xl font-semibold drawdown-value">
                              ${value.toFixed(2)}%
                            </span>
                            ${badge}
                          </div>
                          ${progress}
                          <div class="flex justify-between text-xs text-gray-500 mt-1">
                            <span>${0}%</span>
                            <span>${max}%</span>
                          </div>
                          <div
                            class="flex items-center justify-between mt-2 text-xs text-gray-500"
                          >
                            <span>${value.toFixed(2)}% drawdown</span>
                            <span>${date.toLocaleString()}</span>
                          </div>
                          <div class="flex items-center justify-center mt-2">
                            ${
                              value < max
                                ? "<i data-lucide='check-circle-2' class='text-blue-500'></i>"
                                : "<i data-lucide='alert-circle' class='text-rose-500'></i>"
                            }
                          </div>
                        </div>
                      </div>
                    `;

          $("#max-drawdown-content").append(html);

          lucide.createIcons();
        });

        function getBadge(status) {
          switch (status) {
            case "passed":
              return '<span class="bg-green-100 text-green-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded">Passed</span>';
            case "stable":
              return '<span class="bg-blue-100 text-blue-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded">Stable</span>';
            case "rejected":
              return '<span class="bg-red-100 text-red-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded">Rejected</span>';
            default:
              return '<span class="bg-gray-100 text-gray-800 text-xs font-medium me-2 px-2.5 py-0.5 rounded">None</span>';
          }
        }

        function getProgress(value, max) {
          const transform = `-${100 - value * (100 / max)}%`;

          return `
                        <div class="relative h-3 w-full overflow-hidden rounded-full bg-gray-100">
                          <div
                            class="h-full flex-1 transition-all transform ${
                              value < max ? "bg-blue-500" : "bg-rose-500"
                            }"
                            style="transform: translateX(${transform})"
                          >
                          </div>
                        </div>
                      `;
        }
      };

      // End Max Drawdowm Functionality

      // History Charts
      const renderHistoryCharts = (balances, growthes) => {
        const $content = $("#history-charts-content");
        const $tabs = $(".history-tabs-button");
        const defaultTab = "balance";

        function switchTab(tabName) {
          $tabs.removeClass("text-black bg-white rounded-lg shadow");
          $(`#${tabName}-tab`).addClass(
            "text-black bg-white rounded-lg shadow"
          );

          if (tabName === "balance") {
            $("#balance").removeClass("hidden");
            $("#growth").addClass("hidden");
          }
          if (tabName === "growth") {
            console.log("gro");

            $("#growth").removeClass("hidden");
            $("#balance").addClass("hidden");
          }
        }

        switchTab(defaultTab);

        $tabs.on("click", function () {
          const tabName = $(this).attr("id").replace("-tab", "");
          switchTab(tabName);
        });

        const balanceData = balances?.map((item) => ({
          x: new Date(item.Time).toLocaleDateString("en-US", {
            month: "short",
            day: "numeric",
          }),
          y: item.Balance.toFixed(2),
        }));

        const growthData = growthes?.map((item) => ({
          x: new Date(item.Time).toLocaleDateString("en-US", {
            month: "short",
            day: "numeric",
          }),
          y: item.Balance.toFixed(2),
        }));
        console.log(balances);

        const balanceChartCtx = $("#balanceChart")[0].getContext("2d");
        const growthChartCtx = $("#growthChart")[0].getContext("2d");

        const balanceGradient = balanceChartCtx.createLinearGradient(
          0,
          0,
          0,
          450
        );
        balanceGradient.addColorStop(0, "rgba(59, 130, 246, 1)");
        balanceGradient.addColorStop(0.6, "rgba(59, 130, 246, 0.5)");
        balanceGradient.addColorStop(1, "rgba(59, 130, 246, 0.1)");

        const growthGradient = growthChartCtx.createLinearGradient(
          0,
          0,
          0,
          450
        );
        growthGradient.addColorStop(0, "rgba(153, 102, 255, 1)");
        growthGradient.addColorStop(0.5, "rgba(153, 102, 255, 0.8)");
        growthGradient.addColorStop(1, "rgba(153, 102, 255, 0.1)");

        const balanceChart = new Chart(balanceChartCtx, {
          type: "line",
          data: {
            datasets: [
              {
                label: "Balance",
                data: balanceData,
                borderColor: "#3b82f6",
                backgroundColor: balanceGradient,
                borderWidth: 1,
                pointStyle: "circle",
                pointRadius: 1,
                pointHoverRadius: 10,
                fill: true,
                tension: 0.1,
              },
            ],
          },
          options: {
            scales: {
              x: {
                type: "category",
                grid: {
                  display: false,
                },
                ticks: {
                  callback: function (value) {
                    return new Date(
                      this.getLabelForValue(value)
                    ).toLocaleDateString("en-US", {
                      month: "short",
                      day: "numeric",
                    });
                  },
                },
              },
              y: {
                beginAtZero: false,
                grid: {
                  color: "#e5e5e5",
                  drawBorder: false,
                },
                ticks: {
                  count: 10,
                  callback: function (value) {
                    return `$${value.toFixed(2)}`;
                  },
                },
              },
            },
            plugins: {
              tooltip: {
                callbacks: {
                  title: function (context) {
                    return new Date(context[0].label).toLocaleDateString(
                      "en-US",
                      {
                        month: "short",
                        day: "numeric",
                        year: "numeric",
                      }
                    );
                  },
                  label: function (context) {
                    return `Balance: ${new Intl.NumberFormat("en-US", {
                      style: "currency",
                      currency: "USD",
                    }).format(context.raw.y)}`;
                  },
                },
              },
            },
          },
        });

        // Initialize Growth Chart
        const growthChart = new Chart(growthChartCtx, {
          type: "line",
          data: {
            datasets: [
              {
                label: "Growth",
                data: growthData,
                borderColor: "#a855f7",
                backgroundColor: growthGradient,
                borderWidth: 1,
                pointStyle: "circle",
                pointRadius: 1,
                pointHoverRadius: 10,
                fill: true,
                tension: 0.1,
              },
            ],
          },
          options: {
            scales: {
              x: {
                type: "category",
                grid: {
                  display: false,
                },
                ticks: {
                  callback: function (value) {
                    return new Date(
                      this.getLabelForValue(value)
                    ).toLocaleDateString("en-US", {
                      month: "short",
                      day: "numeric",
                    });
                  },
                },
              },
              y: {
                beginAtZero: false,
                grid: {
                  color: "#e5e5e5",
                  drawBorder: false,
                },
                ticks: {
                  count: 10,
                  callback: function (value) {
                    return `$${value.toFixed(2)}`;
                  },
                },
              },
            },
            plugins: {
              tooltip: {
                callbacks: {
                  title: function (context) {
                    return new Date(context[0].label).toLocaleDateString(
                      "en-US",
                      {
                        month: "short",
                        day: "numeric",
                        year: "numeric",
                      }
                    );
                  },
                  label: function (context) {
                    return `Growth: ${new Intl.NumberFormat("en-US", {
                      style: "currency",
                      currency: "USD",
                    }).format(context.raw.y)}`;
                  },
                },
              },
            },
          },
        });
      };
      // End History Charts

      $(document).ready(async function () {
        // Tab switching logic
        const MainTabElements = [
          {
            id: "analyze",
            triggerEl: $("#analyze-tab"),
            targetEl: $("#analyze"),
          },
          {
            id: "history",
            triggerEl: $("#history-tab"),
            targetEl: $("#history"),
          },
        ];

        const MainTabOptions = {
          defaultTabId: "analyze",
          activeClasses:
            "text-blue-600 hover:text-blue-600 rounded-lg bg-slate-100 border-none",
          inactiveClasses: "text-gray-500 hover:text-gray-600",
          onShow: () => {
            console.log("tab is shown");
          },
        };

        function showTab(tabId) {
          MainTabElements.forEach((tab) => {
            if (tab.id === tabId) {
              tab.triggerEl
                .addClass(MainTabOptions.activeClasses)
                .removeClass(MainTabOptions.inactiveClasses);
              tab.targetEl.removeClass("hidden");
              MainTabOptions.onShow();
            } else {
              tab.triggerEl
                .removeClass(MainTabOptions.activeClasses)
                .addClass(MainTabOptions.inactiveClasses);
              tab.targetEl.addClass("hidden");
            }
          });
        }

        showTab(MainTabOptions.defaultTabId);

        $(".main-tab-button").on("click", function () {
          const tabId = $(this).attr("id").split("-")[0];
          showTab(tabId);
        });
        // End Tabs Switching

        // Fetching Analyze Data
        const login = 115211;

        const analyzeUrl = `https://socket.unfxco.com/mt5/api/analyze/basic?login=${login}`;
        const analyzeData = await fetchData(analyzeUrl);
        // const drawdownUrl = `https://socket.unfxco.com/mt5/api/analyze/drawdown/chart?login=${login}`;
        // const drawdownData = await fetchData(drawdownUrl);

        console.log(analyzeData);
        // console.log(drawdownData);

        const {
          Summary,
          PropAnalyze,
          NowStatus,
          HistoryBalance,
          HistoryGrowth,
        } = analyzeData;

        const { LimitVolume, ...res } = PropAnalyze;
        const newPropAnalyze = {
          ...res,
          RelativeDrawdown: NowStatus.RelativeDrawdown,
        };

        // const {
        //   MaxAllTimeBalanceDrawdown,
        //   MaxAllTimeBalanceDrawdownTime,
        //   MaxDayBalanceDrawdown,
        //   MaxDayBalanceDrawdownTime,
        //   MaxEODBalanceDrawdown,
        //   MaxEODBalanceDrawdownTime,
        //   MaxFloatingDrawdown,
        //   MaxFloatingDrawdownTime,
        //   MaxStartBalanceDrawdown,
        //   MaxStartBalanceDrawdownTime,
        // } = drawdownData;

        // End Fetching Analyze Data

        renderSumStats(Summary);
        renderSumChart(Summary);
        // End Display Summary

        // Display Prop Analyze
        renderPropAnalyze(newPropAnalyze);
        // End Display Prop Analyze

        // Display Max Drawdown
        // const maxDrawdown = {
        //   MaxAllTimeBalanceDrawdown,
        //   MaxAllTimeBalanceDrawdownTime,
        //   MaxDayBalanceDrawdown,
        //   MaxDayBalanceDrawdownTime,
        //   MaxEODBalanceDrawdown,
        //   MaxEODBalanceDrawdownTime,
        //   MaxFloatingDrawdown,
        //   MaxFloatingDrawdownTime,
        //   MaxStartBalanceDrawdown,
        //   MaxStartBalanceDrawdownTime,
        // };

        // renderMaxDrawdown({
        //   ...drawdownData.ShowChartDrawdown,
        //   ...maxDrawdown,
        // });
        // End Display Max Drawdown

        renderHistoryCharts(HistoryBalance, HistoryGrowth);

        // Initialize DataTables
        $("#salesTable").DataTable();
      });
    </script>
  </body>
</html>
